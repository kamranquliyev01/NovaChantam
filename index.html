<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <title>Nova Chantam Məhsullar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input {
      padding: 8px;
      font-size: 16px;
    }
    button {
      padding: 8px 12px;
      font-size: 16px;
      margin-left: 8px;
      cursor: pointer;
    }
    .product {
      border: 1px solid #ccc;
      padding: 12px;
      margin-top: 16px;
      border-radius: 8px;
    }
    .product img {
      max-width: 200px;
      display: block;
      margin-bottom: 8px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>Nova Chantam Məhsul Axtar</h1>
  <input type="text" id="searchInput" placeholder="Kod">
  <button onclick="searchProduct()">Axtar</button>
  <div id="result"></div>

  <script>
    const apiKey = 'AIzaSyB4VnAv_NKDknPZLTcD8JhZy5D3ONx-M2k';
    const sheetId = '1N2xdNZCFvvbQj6W46TUtCMyVLvqpXC49BuQ3ZC16CX8';
    const range = 'Sayfa1';

    async function fetchData() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;
      const response = await fetch(url);
      const data = await response.json();
      return data.values;
    }

    async function searchProduct() {
      const input = document.getElementById('searchInput').value.trim();
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = 'Yüklənir...';

      try {
        const rows = await fetchData();
        const headers = rows[0];
        const kodIndex = headers.indexOf('Kod');

        const product = rows.find((row, idx) => idx !== 0 && row[kodIndex] === input);

        if (product) {
          const productData = {};
          headers.forEach((h, i) => {
            productData[h] = product[i] || '';
          });

          resultDiv.innerHTML = `
            <div class="product">
              <img src="${productData['Şəkil']}" alt="Məhsul şəkli" onerror="this.style.display='none'">
              <p><strong>Kod:</strong> ${productData['Kod']}</p>
              <p><strong>Qiymət:</strong> ${productData['Qiymət']}</p>
              <p><strong>Açıqlama:</strong> ${productData['Açıqlama']}</p>
              <p><a href="${productData['İnstagram linki']}" target="_blank" rel="noopener noreferrer">Instagramda bax</a></p>
            </div>
          `;
        } else {
          resultDiv.innerHTML = 'Bu kodla uyğun məhsul tapılmadı.';
        }
      } catch (error) {
        console.error(error);
        resultDiv.innerHTML = 'Xəta baş verdi.';
      }
    }
  </script>
</body>
</html>
